<!-- 
  Call-to-Action (CTA) Section Component
  
  A flexible, accessible CTA section that can be used for lead generation,
  newsletter signups, product promotions, or any conversion-focused content.
  
  Usage Examples:
  
  Basic CTA:
  <section class="cta-section">
    <div class="cta-section__content">
      <h2 class="cta-section__title">Ready to get started?</h2>
      <p class="cta-section__description">Join thousands of users already using our platform.</p>
      <a href="/signup" class="cta-section__button">Get Started Today</a>
    </div>
  </section>
  
  CTA with form:
  <section class="cta-section cta-section--form">
    <div class="cta-section__content">
      <h2 class="cta-section__title">Stay Updated</h2>
      <p class="cta-section__description">Get the latest news and updates delivered to your inbox.</p>
      <form class="cta-section__form" action="/subscribe" method="post">
        <div class="cta-section__form-group">
          <label for="email" class="sr-only">Email address</label>
          <input type="email" id="email" name="email" placeholder="Enter your email" required>
          <button type="submit">Subscribe</button>
        </div>
      </form>
    </div>
  </section>
  
  CTA with background image:
  <section class="cta-section cta-section--hero" style="--cta-bg-image: url('background.jpg')">
    <div class="cta-section__content">
      <h2 class="cta-section__title">Transform Your Business</h2>
      <p class="cta-section__description">Discover how our solutions can help you achieve your goals.</p>
      <div class="cta-section__actions">
        <a href="/demo" class="cta-section__button cta-section__button--primary">Book Demo</a>
        <a href="/learn-more" class="cta-section__button cta-section__button--secondary">Learn More</a>
      </div>
    </div>
  </section>
-->

<section 
  class="cta-section" 
  role="region" 
  aria-labelledby="cta-title"
>
  <div class="cta-section__container">
    <div class="cta-section__content">
      <!-- Main headline -->
      <h2 id="cta-title" class="cta-section__title">
        Ready to Transform Your Business?
      </h2>
      
      <!-- Supporting description -->
      <p class="cta-section__description">
        Join thousands of companies already using our platform to streamline their operations and drive growth. Start your free trial today.
      </p>
      
      <!-- Call-to-action buttons -->
      <div class="cta-section__actions">
        <a 
          href="/get-started" 
          class="cta-section__button cta-section__button--primary"
          role="button"
        >
          Start Free Trial
        </a>
        
        <a 
          href="/demo" 
          class="cta-section__button cta-section__button--secondary"
          role="button"
        >
          Schedule Demo
        </a>
      </div>
      
      <!-- Optional trust indicators -->
      <div class="cta-section__trust">
        <p class="cta-section__trust-text">
          <span class="cta-section__trust-icon" aria-hidden="true">✓</span>
          No credit card required
        </p>
        <p class="cta-section__trust-text">
          <span class="cta-section__trust-icon" aria-hidden="true">✓</span>
          14-day free trial
        </p>
        <p class="cta-section__trust-text">
          <span class="cta-section__trust-icon" aria-hidden="true">✓</span>
          Cancel anytime
        </p>
      </div>
    </div>
    
    <!-- Optional visual element -->
    <div class="cta-section__visual" aria-hidden="true">
      <div class="cta-section__decoration"></div>
    </div>
  </div>
</section>



<script>
  // CTA Section Component JavaScript
  (function() {
    'use strict';
    
    class CTASection {
      constructor(element) {
        this.element = element;
        this.form = element.querySelector('.cta-section__form');
        this.buttons = element.querySelectorAll('.cta-section__button');
        
        this.init();
      }
      
      init() {
        this.setupFormHandling();
        this.setupButtonAnalytics();
        this.setupAccessibility();
      }
      
      setupFormHandling() {
        if (this.form) {
          this.form.addEventListener('submit', this.handleFormSubmit.bind(this));
          
          // Enhance form validation
          const emailInput = this.form.querySelector('input[type="email"]');
          if (emailInput) {
            emailInput.addEventListener('blur', this.validateEmail.bind(this));
          }
        }
      }
      
      setupButtonAnalytics() {
        this.buttons.forEach((button, index) => {
          button.addEventListener('click', (event) => {
            // Track CTA clicks for analytics
            this.trackCTAClick(button, index);
          });
        });
      }
      
      setupAccessibility() {
        // Ensure proper ARIA attributes
        const title = this.element.querySelector('.cta-section__title');
        if (title && !this.element.getAttribute('aria-labelledby')) {
          if (!title.id) {
            title.id = `cta-title-${Date.now()}`;
          }
          this.element.setAttribute('aria-labelledby', title.id);
        }
      }
      
      handleFormSubmit(event) {
        event.preventDefault();
        
        const formData = new FormData(this.form);
        const email = formData.get('email');
        
        if (!this.validateEmail({ target: { value: email } })) {
          return;
        }
        
        this.setLoading(true);
        
        // Submit form data (replace with actual API call)
        this.submitForm(formData)
          .then(response => {
            this.showSuccess('Thank you for subscribing!');
            this.form.reset();
          })
          .catch(error => {
            this.showError('Something went wrong. Please try again.');
          })
          .finally(() => {
            this.setLoading(false);
          });
      }
      
      validateEmail(event) {
        const email = event.target.value;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (email && !emailRegex.test(email)) {
          this.showInputError(event.target, 'Please enter a valid email address');
          return false;
        } else {
          this.clearInputError(event.target);
          return true;
        }
      }
      
      showInputError(input, message) {
        // Remove existing error
        this.clearInputError(input);
        
        // Add error styling
        input.classList.add('error');
        input.setAttribute('aria-invalid', 'true');
        
        // Create error message
        const errorElement = document.createElement('div');
        errorElement.className = 'cta-section__error';
        errorElement.textContent = message;
        errorElement.id = `${input.id || 'input'}-error`;
        
        input.setAttribute('aria-describedby', errorElement.id);
        input.parentNode.appendChild(errorElement);
      }
      
      clearInputError(input) {
        input.classList.remove('error');
        input.removeAttribute('aria-invalid');
        input.removeAttribute('aria-describedby');
        
        const existingError = input.parentNode.querySelector('.cta-section__error');
        if (existingError) {
          existingError.remove();
        }
      }
      
      setLoading(isLoading) {
        const submitButton = this.form?.querySelector('button[type="submit"]');
        
        if (submitButton) {
          submitButton.disabled = isLoading;
          submitButton.textContent = isLoading ? 'Subscribing...' : 'Subscribe';
          submitButton.setAttribute('aria-busy', isLoading.toString());
        }
      }
      
      showSuccess(message) {
        this.showMessage(message, 'success');
      }
      
      showError(message) {
        this.showMessage(message, 'error');
      }
      
      showMessage(message, type) {
        // Remove existing messages
        const existingMessage = this.element.querySelector('.cta-section__message');
        if (existingMessage) {
          existingMessage.remove();
        }
        
        // Create new message
        const messageElement = document.createElement('div');
        messageElement.className = `cta-section__message cta-section__message--${type}`;
        messageElement.textContent = message;
        messageElement.setAttribute('role', type === 'error' ? 'alert' : 'status');
        messageElement.setAttribute('aria-live', 'polite');
        
        // Insert after form or actions
        const insertAfter = this.form || this.element.querySelector('.cta-section__actions');
        if (insertAfter) {
          insertAfter.parentNode.insertBefore(messageElement, insertAfter.nextSibling);
        }
        
        // Auto-remove success messages
        if (type === 'success') {
          setTimeout(() => {
            messageElement.remove();
          }, 5000);
        }
      }
      
      async submitForm(formData) {
        // Replace with actual API endpoint
        const response = await fetch('/api/subscribe', {
          method: 'POST',
          body: formData
        });
        
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        
        return response.json();
      }
      
      trackCTAClick(button, index) {
        // Analytics tracking (replace with your analytics provider)
        if (typeof gtag !== 'undefined') {
          gtag('event', 'cta_click', {
            event_category: 'CTA',
            event_label: button.textContent,
            value: index
          });
        }
        
        // Custom event for other tracking systems
        this.element.dispatchEvent(new CustomEvent('cta:click', {
          bubbles: true,
          detail: {
            button: button,
            index: index,
            text: button.textContent
          }
        }));
      }
    }
    
    // Auto-initialize all CTA sections
    function initCTASections() {
      const ctaSections = document.querySelectorAll('.cta-section');
      ctaSections.forEach(section => {
        if (!section._ctaSection) {
          section._ctaSection = new CTASection(section);
        }
      });
    }
    
    // Global API
    window.CTASection = CTASection;
    
    // Auto-initialize on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initCTASections);
    } else {
      initCTASections();
    }
  })();
</script>

<!-- Additional CSS for form error states and messages -->
